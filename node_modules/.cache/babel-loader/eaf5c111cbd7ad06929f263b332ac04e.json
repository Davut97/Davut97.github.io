{"ast":null,"code":"import { createElement, Component } from 'react';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __awaiter(thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nfunction __generator(thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n}\n\nfunction createCommonjsModule(fn, module) {\n  return module = {\n    exports: {}\n  }, fn(module, module.exports), module.exports;\n}\n\nvar classnames = createCommonjsModule(function (module) {\n  /*!\n    Copyright (c) 2017 Jed Watson.\n    Licensed under the MIT License (MIT), see\n    http://jedwatson.github.io/classnames\n  */\n\n  /* global define */\n  (function () {\n    var hasOwn = {}.hasOwnProperty;\n\n    function classNames() {\n      var classes = [];\n\n      for (var i = 0; i < arguments.length; i++) {\n        var arg = arguments[i];\n        if (!arg) continue;\n        var argType = typeof arg;\n\n        if (argType === 'string' || argType === 'number') {\n          classes.push(arg);\n        } else if (Array.isArray(arg) && arg.length) {\n          var inner = classNames.apply(null, arg);\n\n          if (inner) {\n            classes.push(inner);\n          }\n        } else if (argType === 'object') {\n          for (var key in arg) {\n            if (hasOwn.call(arg, key) && arg[key]) {\n              classes.push(key);\n            }\n          }\n        }\n      }\n\n      return classes.join(' ');\n    }\n\n    if (module.exports) {\n      classNames.default = classNames;\n      module.exports = classNames;\n    } else {\n      window.classNames = classNames;\n    }\n  })();\n});\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css = \"/* add css styles here (optional) */\\n\\n.styles_wrapper__3KXDn {\\n  display: flex;\\n  flex-direction: column;\\n  background-color: black;\\n  color: white;\\n  font-family: monospace;\\n  font-size: 12px;\\n  padding: 10px;\\n  height: 300px;\\n}\\n\\n.styles_promptWrapper__2Cy1Y {\\n  display: flex;\\n}\\n\\n.styles_line__1lhnu {\\n  font-size: 12px;\\n  line-height: 12px;\\n  font-family: monospace;\\n  background: transparent !important; /* we want to make this transparent whatever happens in the app*/\\n  padding: 0;\\n  color: white;\\n}\\n\\n.styles_prompt__1nRph {\\n  display: flex;\\n  align-items: center;\\n}\\n\\n.styles_input__15JGo {\\n  flex: 1;\\n  background: transparent !important; /* we want to make this transparent whatever happens in the app*/\\n  border: none;\\n  outline: none;\\n  color: white;\\n  font-family: monospace;\\n  font-size: 13px;\\n}\\n\";\nvar styles = {\n  \"wrapper\": \"styles_wrapper__3KXDn\",\n  \"promptWrapper\": \"styles_promptWrapper__2Cy1Y\",\n  \"line\": \"styles_line__1lhnu\",\n  \"prompt\": \"styles_prompt__1nRph\",\n  \"input\": \"styles_input__15JGo\"\n};\nstyleInject(css);\n/**\r\n * @class ReactConsole\r\n */\n// @ts-ignore\n\nvar isIE11 = !!window.MSInputMethodContext && !!document.documentMode;\n\nvar ReactConsole =\n/** @class */\nfunction (_super) {\n  __extends(ReactConsole, _super);\n\n  function ReactConsole() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.inputRef = null;\n    _this.wrapperRef = null;\n    _this.reverseStringRef = null;\n    _this.state = {\n      input: '',\n      output: [],\n      commandInProgress: false,\n      reverseSearchString: undefined,\n      historyPosition: Infinity,\n      reverseSearchPosition: Infinity\n    };\n\n    _this.clear = function () {\n      _this.setState({\n        output: [],\n        input: ''\n      });\n    };\n\n    _this.scrollToBottom = function () {\n      setTimeout(function () {\n        _this.wrapperRef.scrollTop = _this.wrapperRef.scrollHeight;\n      });\n    };\n    /**\r\n     * Get filtered history entries based on reverse search string\r\n     */\n\n\n    _this.getReverseHistory = function () {\n      var reverseSearchString = _this.state.reverseSearchString;\n      return _this.props.history === undefined ? [] : _this.props.history.map(function (entry) {\n        return reverseSearchString === undefined || reverseSearchString === '' ? // @ts-ignore\n        false : entry.indexOf(reverseSearchString) !== -1;\n      });\n    };\n    /**\r\n     * Takes current text of a main input and generates a string that will be outputted as a log.\r\n     */\n\n\n    _this.getCurrentTextSnapshot = function () {\n      var prompt = _this.props.prompt;\n      var inputString = _this.state.input;\n      return prompt + \"\\u00A0\" + inputString;\n    };\n\n    _this.onSubmit = function (e) {\n      return __awaiter(_this, void 0, void 0, function () {\n        var _a, inputString, log, _b, cmd, args, command, ret, cmdNotFound;\n\n        return __generator(this, function (_c) {\n          switch (_c.label) {\n            case 0:\n              e.preventDefault();\n              inputString = this.state.input;\n\n              if (inputString === null) {\n                return [2\n                /*return*/\n                ];\n              }\n\n              log = this.getCurrentTextSnapshot();\n\n              if (inputString === '') {\n                this.setState({\n                  output: this.state.output.concat([log]),\n                  input: ''\n                });\n                this.scrollToBottom();\n                return [2\n                /*return*/\n                ];\n              }\n\n              this.addHistoryEntry(inputString);\n              _b = inputString.split(\" \"), cmd = _b[0], args = _b.slice(1);\n\n              if (cmd === 'clear') {\n                this.clear();\n                return [2\n                /*return*/\n                ];\n              }\n\n              command = this.props.commands[cmd];\n              this.setState({\n                commandInProgress: true\n              });\n              if (!command) return [3\n              /*break*/\n              , 2];\n              return [4\n              /*yield*/\n              , command.fn.apply(command, args)];\n\n            case 1:\n              ret = _c.sent();\n              this.setState({\n                output: this.state.output.concat([log, ret])\n              });\n              return [3\n              /*break*/\n              , 4];\n\n            case 2:\n              return [4\n              /*yield*/\n              , (_a = this.props).noCommandFound.apply(_a, [cmd].concat(args))];\n\n            case 3:\n              cmdNotFound = _c.sent();\n              this.setState({\n                output: this.state.output.concat([log, cmdNotFound])\n              });\n              _c.label = 4;\n\n            case 4:\n              this.setState({\n                commandInProgress: false,\n                input: ''\n              });\n              this.inputRef.focus();\n              this.scrollToBottom();\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n    /**\r\n     * Reverse search input handler\r\n     * @param event\r\n     */\n\n\n    _this.onReverseStringInputChange = function (event) {\n      _this.setState({\n        reverseSearchString: event.target.value\n      }, function () {\n        var history = _this.getReverseHistory();\n\n        var historyIndex = history.lastIndexOf(true);\n\n        _this.executeNextReverseSearch(historyIndex);\n      });\n    };\n    /**\r\n     * Invoked when pressed ctrl+r and already in a reverse search mode.\r\n     */\n\n\n    _this.nextReverseSearch = function () {\n      var history = _this.getReverseHistory();\n\n      var endOffset = Math.max(0, _this.state.reverseSearchPosition - 1); // so that we don't go from the end again\n\n      var historyIndex = history.lastIndexOf(true, endOffset);\n\n      _this.executeNextReverseSearch(historyIndex);\n    };\n    /**\r\n     * Helper function that sets the history preview based on a requested history index.\r\n     * @param historyIndex\r\n     */\n\n\n    _this.executeNextReverseSearch = function (historyIndex) {\n      _this.setState({\n        reverseSearchPosition: historyIndex\n      });\n\n      if (historyIndex !== -1) {\n        _this.setPreviewPosition(historyIndex);\n      }\n\n      if (_this.state.reverseSearchString === '') {\n        _this.setPreviewPosition(Infinity);\n      }\n    };\n    /**\r\n     * This function sets a given history entry as a main input element content.\r\n     * It's called when changing the preview of a 'current' history entry e.g. by ctrl+r call, or\r\n     * when pressing up/down arrow.\r\n     * @param historyPosition\r\n     */\n\n\n    _this.setPreviewPosition = function (historyPosition) {\n      if (_this.props.history === undefined) {\n        return;\n      }\n\n      _this.setState({\n        historyPosition: historyPosition,\n        input: _this.props.history[historyPosition] || ''\n      });\n    };\n    /**\r\n     * Enables reverse search.\r\n     * The side effect is that we focus o reverse search input.\r\n     */\n\n\n    _this.onReverseSearch = function () {\n      // we enabled reverse search\n      _this.setState({\n        reverseSearchString: ''\n      }, function () {\n        _this.reverseStringRef.focus();\n      });\n    };\n    /**\r\n     * When reverse search is confirmed, we disable reverse search mode and keep the result.\r\n     * @param e\r\n     */\n\n\n    _this.onReverseSearchSubmit = function (event) {\n      event.preventDefault();\n\n      _this.disableReverseSearch();\n    };\n    /**\r\n     * Main input change handler.\r\n     * @param event\r\n     */\n\n\n    _this.onInputChange = function (event) {\n      _this.setState({\n        input: event.target.value\n      });\n    };\n    /**\r\n     * Helper function to determine whether reverse search is active or not.\r\n     */\n\n\n    _this.isReverseSearchOn = function () {\n      return _this.state.reverseSearchString !== undefined;\n    };\n    /**\r\n     * Disables reverse search mode.\r\n     * @param keepPreviewString - determines whether the result of a reverse search should be kept or not\r\n     */\n\n\n    _this.disableReverseSearch = function (keepPreviewString) {\n      if (keepPreviewString === void 0) {\n        keepPreviewString = true;\n      }\n\n      _this.setState({\n        reverseSearchString: undefined\n      });\n\n      if (!keepPreviewString) {\n        _this.setState({\n          input: ''\n        });\n      }\n\n      setTimeout(function () {\n        _this.inputRef.focus();\n      });\n    };\n    /**\r\n     * onKeyDown implementation of a reverse search input.\r\n     * @param event\r\n     */\n\n\n    _this.onReverseKeyDown = function (event) {\n      if (event.which === 38 || event.which === 40) {\n        // up or down\n        _this.disableReverseSearch();\n\n        event.preventDefault();\n      } else if (event.which === 67 && event.ctrlKey) {\n        // ctrl + c\n        _this.disableReverseSearch(false);\n\n        event.preventDefault();\n      } else if (event.which === 82 && event.ctrlKey) {\n        // ctrl + r\n        _this.nextReverseSearch();\n\n        event.preventDefault();\n      }\n    };\n    /**\r\n     * onKeyDown implementation of a main input.\r\n     * @param event\r\n     */\n\n\n    _this.onKeyDown = function (event) {\n      if (event.which === 38) {\n        // key up\n        if (_this.props.history === undefined) {\n          return;\n        }\n\n        var currentPos = Math.min(_this.state.historyPosition, _this.props.history.length);\n        var historyPosition = Math.max(0, currentPos - 1);\n\n        _this.setPreviewPosition(historyPosition);\n\n        event.preventDefault();\n      } else if (event.which === 40) {\n        if (_this.props.history === undefined) {\n          return;\n        }\n\n        var historyPosition = Math.min(_this.props.history.length, _this.state.historyPosition + 1);\n\n        _this.setPreviewPosition(historyPosition);\n\n        event.preventDefault();\n      } else if (event.which === 82 && event.ctrlKey) {\n        // ctrl + r\n        if (_this.props.history === undefined) {\n          return;\n        }\n\n        _this.onReverseSearch();\n\n        event.preventDefault();\n      } else if (event.which === 67 && event.ctrlKey) {\n        // ctrl + c\n        _this.setState({\n          output: _this.state.output.concat([_this.getCurrentTextSnapshot()]),\n          input: ''\n        });\n\n        _this.scrollToBottom();\n\n        event.preventDefault();\n      }\n    };\n    /**\r\n     * Focuses console input.\r\n     * Whenever an user clicks on a terminal, we want to focus an actual input where he/she can type.\r\n     */\n\n\n    _this.focusConsole = function () {\n      if (_this.inputRef) {\n        if (document.getSelection().isCollapsed) {\n          _this.inputRef.focus();\n        }\n      }\n    };\n    /**\r\n     * Calls onAddHistoryItem property and sets historyPosition to a default value.\r\n     * @param inputString\r\n     */\n\n\n    _this.addHistoryEntry = function (inputString) {\n      var onAddHistoryItem = _this.props.onAddHistoryItem;\n\n      if (typeof onAddHistoryItem === 'function') {\n        onAddHistoryItem(inputString);\n      }\n\n      _this.setState({\n        historyPosition: Infinity\n      });\n    };\n\n    return _this;\n  }\n\n  ReactConsole.prototype.componentDidMount = function () {\n    var welcomeMessage = this.props.welcomeMessage;\n\n    if (welcomeMessage) {\n      this.setState({\n        output: [welcomeMessage]\n      });\n    }\n\n    if (this.props.history !== undefined) {\n      this.setState({\n        historyPosition: this.props.history.length\n      });\n    }\n  };\n\n  ReactConsole.prototype.render = function () {\n    var _this = this;\n\n    var _a = this.props,\n        wrapperClassName = _a.wrapperClassName,\n        promptClassName = _a.promptClassName,\n        inputClassName = _a.inputClassName,\n        wrapperStyle = _a.wrapperStyle,\n        promptStyle = _a.promptStyle,\n        inputStyle = _a.inputStyle,\n        prompt = _a.prompt,\n        autoFocus = _a.autoFocus;\n    var promptClass = promptClassName ? styles.prompt + \" \" + promptClassName : styles.prompt;\n    return createElement(\"div\", {\n      className: classnames([styles.wrapper, wrapperClassName]),\n      style: __assign({\n        overflowY: isIE11 ? \"scroll\" : \"auto\"\n      }, wrapperStyle),\n      onClick: this.focusConsole,\n      ref: function (ref) {\n        return _this.wrapperRef = ref;\n      }\n    }, createElement(\"div\", null, this.state.output.map(function (line, key) {\n      return createElement(\"pre\", {\n        key: key,\n        className: styles.line,\n        dangerouslySetInnerHTML: {\n          __html: line\n        }\n      });\n    })), createElement(\"form\", {\n      onSubmit: this.onSubmit\n    }, createElement(\"div\", {\n      className: classnames([styles.promptWrapper, promptClassName]),\n      style: promptStyle\n    }, createElement(\"span\", {\n      className: promptClass\n    }, prompt, \"\\u00A0\"), createElement(\"input\", {\n      disabled: this.state.commandInProgress || this.isReverseSearchOn(),\n      ref: function (ref) {\n        return _this.inputRef = ref;\n      },\n      autoFocus: autoFocus,\n      value: this.state.input,\n      onChange: this.onInputChange,\n      onKeyDown: this.onKeyDown,\n      autoComplete: 'off',\n      spellCheck: false,\n      autoCapitalize: 'false',\n      name: \"input\",\n      className: classnames([styles.input, inputClassName]),\n      style: inputStyle\n    }))), this.isReverseSearchOn() && createElement(\"form\", {\n      onSubmit: this.onReverseSearchSubmit\n    }, \"bck-i-search: \", createElement(\"input\", {\n      value: this.state.reverseSearchString,\n      ref: function (ref) {\n        return _this.reverseStringRef = ref;\n      },\n      onKeyDown: this.onReverseKeyDown,\n      className: classnames([styles.input, inputClassName]),\n      onChange: this.onReverseStringInputChange\n    })));\n  };\n\n  ReactConsole.defaultProps = {\n    prompt: '$',\n    autoFocus: false,\n    noCommandFound: function (cmd) {\n      return Promise.resolve(\"Command \" + cmd + \" does not exist\");\n    },\n    wrapperStyle: {},\n    promptStyle: {},\n    inputStyle: {}\n  };\n  return ReactConsole;\n}(Component);\n\nexport default ReactConsole;","map":{"version":3,"sources":["../node_modules/tslib/tslib.es6.js","../node_modules/classnames/index.js","../node_modules/style-inject/dist/style-inject.es.js","../src/index.tsx"],"names":["React.Component","React.createElement"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/*!\n  Copyright (c) 2017 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg) && arg.length) {\n\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\tif (inner) {\n\t\t\t\t\tclasses.push(inner);\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tfor (var key in arg) {\n\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","/**\n * @class ReactConsole\n */\n\nimport * as React from 'react'\nimport classnames from 'classnames'\n\nimport styles from './styles.css'\n\n// @ts-ignore\nconst isIE11 = !!window.MSInputMethodContext && !!document.documentMode;\n\nexport type Props = {\n  prompt: string,\n  commands: any,\n  welcomeMessage?: string,\n  autoFocus: boolean,\n  noCommandFound: (...str: string[]) => Promise<string>,\n  promptClassName?: string,\n  wrapperClassName?: string,\n  inputClassName?: string,\n  wrapperStyle?: object,\n  promptStyle?: object,\n  inputStyle?: object,\n  history?: Array<string>,\n  onAddHistoryItem?: (entry: string) => void,\n}\n\ntype State = {\n  output: Array<string>,\n  commandInProgress: boolean,\n  input: string,\n  historyPosition: number,\n  reverseSearchString?: string,\n  reverseSearchPosition: number,\n}\n\nexport default class ReactConsole extends React.Component<Props, State> {\n\n  inputRef: any = null;\n  wrapperRef: any = null;\n  reverseStringRef: any = null;\n\n  static defaultProps = {\n    prompt: '$',\n    autoFocus: false,\n    noCommandFound: (cmd: string) => Promise.resolve(`Command ${cmd} does not exist`),\n    wrapperStyle: {},\n    promptStyle: {},\n    inputStyle: {},\n  };\n\n  state = {\n    input: '',\n    output: [],\n    commandInProgress: false,\n    reverseSearchString: undefined,\n    historyPosition: Infinity,\n    reverseSearchPosition: Infinity,\n  };\n\n  componentDidMount() {\n    const {welcomeMessage} = this.props;\n    if (welcomeMessage) {\n      this.setState({\n        output: [welcomeMessage],\n      })\n    }\n    if (this.props.history !== undefined) {\n      this.setState({\n        historyPosition: this.props.history.length,\n      })\n    }\n  }\n\n  public clear = () => {\n    this.setState({output: [], input: ''})\n  };\n\n  public scrollToBottom = () => {\n    setTimeout(() => {\n      this.wrapperRef.scrollTop = this.wrapperRef.scrollHeight\n    })\n  };\n\n  /**\n   * Get filtered history entries based on reverse search string\n   */\n  private getReverseHistory = (): Array<boolean> => {\n    const {reverseSearchString} = this.state;\n    return this.props.history === undefined ?\n      []\n      : this.props.history.map(entry => (reverseSearchString === undefined || reverseSearchString === '') ?\n        // @ts-ignore\n        false : entry.indexOf(reverseSearchString) !== -1)\n  };\n\n  /**\n   * Takes current text of a main input and generates a string that will be outputted as a log.\n   */\n  private getCurrentTextSnapshot = (): string => {\n    const {prompt} = this.props;\n    const inputString: string = this.state.input;\n    return `${prompt}\\xa0${inputString}`;\n  };\n\n  private onSubmit = async (e: any) => {\n    e.preventDefault();\n\n    const inputString: string = this.state.input;\n    if (inputString === null) {\n      return\n    }\n\n    const log = this.getCurrentTextSnapshot();\n\n    if (inputString === '') {\n      this.setState({\n        output: [...this.state.output, log],\n        input: '',\n      });\n      this.scrollToBottom();\n      return\n    }\n\n    this.addHistoryEntry(inputString);\n\n    const [cmd, ...args] = inputString.split(\" \");\n\n    if (cmd === 'clear') {\n      this.clear();\n      return\n    }\n\n    const command = this.props.commands[cmd];\n\n    this.setState({commandInProgress: true});\n\n    if (command) {\n      const ret = await command.fn(...args);\n      this.setState({\n        output: [...this.state.output, log, ret]\n      })\n    } else {\n      const cmdNotFound = await this.props.noCommandFound(cmd, ...args);\n      this.setState({\n        output: [...this.state.output, log, cmdNotFound]\n      })\n    }\n    this.setState({commandInProgress: false, input: ''});\n    this.inputRef.focus()\n    this.scrollToBottom()\n  };\n\n  render() {\n    const {\n      wrapperClassName,\n      promptClassName,\n      inputClassName,\n      wrapperStyle,\n      promptStyle,\n      inputStyle,\n      prompt,\n      autoFocus,\n    } = this.props;\n\n    const promptClass = promptClassName\n      ? `${styles.prompt} ${promptClassName}`\n      : styles.prompt;\n\n    return (\n      <div\n        className={classnames([styles.wrapper, wrapperClassName])}\n        style={{\n          overflowY: isIE11 ? \"scroll\" : \"auto\",\n          ...wrapperStyle,\n        }}\n        onClick={this.focusConsole}\n        ref={ref => this.wrapperRef = ref}\n      >\n        <div>\n          {this.state.output.map((line, key) =>\n            <pre\n              key={key}\n              className={styles.line}\n              dangerouslySetInnerHTML={{__html: line}}\n            />\n          )}\n        </div>\n        <form\n          onSubmit={this.onSubmit}\n        >\n          <div\n            className={classnames([styles.promptWrapper, promptClassName])}\n            style={promptStyle}\n          >\n            <span\n              className={promptClass}\n            >{prompt}&nbsp;</span>\n            <input\n              disabled={this.state.commandInProgress || this.isReverseSearchOn()}\n              ref={ref => this.inputRef = ref}\n              autoFocus={autoFocus}\n              value={this.state.input}\n              onChange={this.onInputChange}\n              onKeyDown={this.onKeyDown}\n              autoComplete={'off'}\n              spellCheck={false}\n              autoCapitalize={'false'}\n              name=\"input\"\n              className={classnames([styles.input, inputClassName])}\n              style={inputStyle}\n            />\n          </div>\n        </form>\n        {this.isReverseSearchOn() && <form onSubmit={this.onReverseSearchSubmit}>bck-i-search: <input\n          value={this.state.reverseSearchString}\n          ref={ref => this.reverseStringRef = ref}\n          onKeyDown={this.onReverseKeyDown}\n          className={classnames([styles.input, inputClassName])}\n          onChange={this.onReverseStringInputChange}\n        />\n        </form>}\n      </div>\n    )\n  }\n\n  /**\n   * Reverse search input handler\n   * @param event\n   */\n  private onReverseStringInputChange = (event: any) => {\n    this.setState({\n      reverseSearchString: event.target.value,\n    }, () => {\n      const history: Array<boolean> = this.getReverseHistory();\n      const historyIndex: number = history.lastIndexOf(true);\n      this.executeNextReverseSearch(historyIndex)\n    })\n  };\n\n  /**\n   * Invoked when pressed ctrl+r and already in a reverse search mode.\n   */\n  private nextReverseSearch = () => {\n    const history: Array<boolean> = this.getReverseHistory();\n    const endOffset = Math.max(0, this.state.reverseSearchPosition - 1); // so that we don't go from the end again\n    const historyIndex: number = history.lastIndexOf(true, endOffset);\n    this.executeNextReverseSearch(historyIndex)\n  };\n\n  /**\n   * Helper function that sets the history preview based on a requested history index.\n   * @param historyIndex\n   */\n  private executeNextReverseSearch = (historyIndex: number) => {\n    this.setState({\n      reverseSearchPosition: historyIndex,\n    });\n    if (historyIndex !== -1) {\n      this.setPreviewPosition(historyIndex)\n    }\n    if (this.state.reverseSearchString === '') {\n      this.setPreviewPosition(Infinity);\n    }\n  };\n\n  /**\n   * This function sets a given history entry as a main input element content.\n   * It's called when changing the preview of a 'current' history entry e.g. by ctrl+r call, or\n   * when pressing up/down arrow.\n   * @param historyPosition\n   */\n  private setPreviewPosition = (historyPosition: number) => {\n    if(this.props.history === undefined) {\n      return\n    }\n    this.setState({\n      historyPosition,\n      input: this.props.history[historyPosition] || '', // if an element history is out of bounds, we just set ''\n    });\n  };\n\n  /**\n   * Enables reverse search.\n   * The side effect is that we focus o reverse search input.\n   */\n  private onReverseSearch = () => {\n    // we enabled reverse search\n    this.setState({\n      reverseSearchString: '',\n    }, () => {\n      this.reverseStringRef.focus()\n    })\n  };\n\n  /**\n   * When reverse search is confirmed, we disable reverse search mode and keep the result.\n   * @param e\n   */\n  private onReverseSearchSubmit = (event: any) => {\n    event.preventDefault();\n    this.disableReverseSearch();\n  };\n\n  /**\n   * Main input change handler.\n   * @param event\n   */\n  private onInputChange = (event: any) => {\n    this.setState({\n      input: event.target.value,\n    })\n  };\n\n  /**\n   * Helper function to determine whether reverse search is active or not.\n   */\n  private isReverseSearchOn = (): boolean => this.state.reverseSearchString !== undefined;\n\n  /**\n   * Disables reverse search mode.\n   * @param keepPreviewString - determines whether the result of a reverse search should be kept or not\n   */\n  private disableReverseSearch = (keepPreviewString: boolean = true) => {\n    this.setState({\n      reverseSearchString: undefined,\n    });\n    if (!keepPreviewString) {\n      this.setState({\n        input: '',\n      })\n    }\n    setTimeout(() => {\n      this.inputRef.focus();\n    });\n  };\n\n  /**\n   * onKeyDown implementation of a reverse search input.\n   * @param event\n   */\n  private onReverseKeyDown = (event: any) => {\n    if (event.which === 38 || event.which === 40) { // up or down\n      this.disableReverseSearch()\n      event.preventDefault();\n    } else if (event.which === 67 && event.ctrlKey) { // ctrl + c\n      this.disableReverseSearch(false);\n      event.preventDefault();\n    } else if (event.which === 82 && event.ctrlKey) { // ctrl + r\n      this.nextReverseSearch();\n      event.preventDefault();\n    }\n  };\n\n  /**\n   * onKeyDown implementation of a main input.\n   * @param event\n   */\n  private onKeyDown = (event: any) => {\n    if (event.which === 38) { // key up\n      if(this.props.history === undefined) {\n        return\n      }\n\n      const currentPos = Math.min(this.state.historyPosition, this.props.history.length);\n      const historyPosition = Math.max(0, currentPos - 1);\n      this.setPreviewPosition(historyPosition);\n      event.preventDefault()\n    } else if (event.which === 40) {\n      if(this.props.history === undefined) {\n        return\n      }\n      const historyPosition = Math.min(this.props.history.length, this.state.historyPosition + 1);\n      this.setPreviewPosition(historyPosition);\n      event.preventDefault()\n    } else if (event.which === 82 && event.ctrlKey) { // ctrl + r\n      if(this.props.history === undefined) {\n        return\n      }\n      this.onReverseSearch()\n      event.preventDefault()\n    } else if (event.which === 67 && event.ctrlKey) { // ctrl + c\n      this.setState({\n        output: [...this.state.output, this.getCurrentTextSnapshot()],\n        input: '',\n      });\n      this.scrollToBottom();\n      event.preventDefault()\n    }\n  };\n\n  /**\n   * Focuses console input.\n   * Whenever an user clicks on a terminal, we want to focus an actual input where he/she can type.\n   */\n  public focusConsole = () => {\n    if (this.inputRef) {\n      if (document.getSelection().isCollapsed) {\n        this.inputRef.focus()\n      }\n    }\n  };\n\n  /**\n   * Calls onAddHistoryItem property and sets historyPosition to a default value.\n   * @param inputString\n   */\n  private addHistoryEntry = (inputString: string) => {\n    const {onAddHistoryItem} = this.props;\n    if (typeof onAddHistoryItem === 'function') {\n      onAddHistoryItem(inputString);\n    }\n    this.setState({\n      historyPosition: Infinity,\n    })\n  }\n}\n"]},"metadata":{},"sourceType":"module"}